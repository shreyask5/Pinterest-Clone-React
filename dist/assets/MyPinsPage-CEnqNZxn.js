import{j as s}from"./ui-vendor-DQgZ_fW4.js";import{r as a,u as P}from"./react-vendor-BUAG6j4M.js";import{q as b,w as C,k as A,l as S,m as D,e as L}from"./firebase-vendor-BdgN93p4.js";import{b as E,e as h,A as g,P as k,d as p}from"./components-BV4oEjAW.js";import"./utils-vendor-yl3LD3r_.js";const Q=()=>{const[d,u]=a.useState([]),[f,o]=a.useState(!0),[r,c]=a.useState(!1),[y,v]=a.useState(!1);P();const{searchQuery:n}=E();a.useEffect(()=>{const e=h.onAuthStateChanged(t=>{if(v(!0),!t)c(!0),o(!1);else{const i=b(A(p,"savedPins"),C("userId","==",t.uid)),N=S(i,l=>{const w=l.docs.map(x=>({id:x.id,...x.data()}));u(w),o(!1)},l=>{console.error("Error fetching pins:",l),o(!1)});return()=>N()}});return()=>e()},[]);const j=async e=>{try{await D(L(p,"savedPins",e)),u(t=>t.filter(i=>i.id!==e))}catch(t){console.error("Error removing pin:",t)}};if(!y||f&&!r)return s.jsx("div",{className:"flex justify-center items-center min-h-screen",children:"Loading..."});if(r&&!h.currentUser)return s.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8 mt-16",children:[s.jsxs("div",{className:"text-center py-12",children:[s.jsx("h1",{className:"text-3xl font-bold mb-4",children:"Sign in to view your pins"}),s.jsx("p",{className:"text-xl text-gray-600 mb-8",children:"Please sign in to access your saved pins."})]}),s.jsx(g,{open:r,onOpenChange:c})]});const m=d.filter(e=>{if(!n)return!0;const t=n.toLowerCase();return e.description.toLowerCase().includes(t)||e.category.toLowerCase().includes(t)||e.title&&e.title.toLowerCase().includes(t)});return s.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8 mt-16",children:[s.jsx("h1",{className:"text-3xl font-bold mb-8",children:"My Pins"}),d.length===0?s.jsx("div",{className:"text-center py-12",children:s.jsx("p",{className:"text-xl text-gray-600",children:"You haven't saved any pins yet."})}):s.jsxs(s.Fragment,{children:[m.length===0&&n&&s.jsx("div",{className:"text-center py-12",children:s.jsxs("p",{className:"text-xl text-gray-600",children:['No pins found matching "',n,'"']})}),s.jsx("div",{className:"columns-1 sm:columns-2 md:columns-3 lg:columns-4 xl:columns-5 gap-2 sm:gap-4",children:m.map(e=>{var t;return s.jsx(k,{image:e.image,title:e.title,description:e.description,category:e.category,uploaderName:e.uploaderName,uploadDate:(t=e.savedAt)!=null&&t.toDate?e.savedAt.toDate():new Date(e.savedAt),onRemove:()=>j(e.id)},e.id)})})]}),s.jsx(g,{open:r,onOpenChange:c})]})};export{Q as default};
